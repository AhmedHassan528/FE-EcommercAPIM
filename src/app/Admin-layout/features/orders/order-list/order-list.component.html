<div class="flex">
    <app-sidebar></app-sidebar>
    <div class="flex-1 p-6">
      <div class="flex justify-between items-center mb-6">
        <h1 class="text-3xl font-bold">Orders</h1>
        <div class="flex gap-4">
          <button (click)="exportToExcel()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 flex items-center">
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
            </svg>
            Export to Excel
          </button>
          <a routerLink="/orders/new" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Create Order</a>
        </div>
      </div>

      <!-- Search Input -->
      <div class="flex gap-4 mb-6">
        <div class="max-w-md flex-1">
          <div class="relative">
            <div class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none">
              <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
                fill="none" viewBox="0 0 20 20">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z" />
              </svg>
            </div>
            <input [(ngModel)]="searchTerm" (ngModelChange)="filterOrders()" type="search" id="default-search"
              class="block w-full p-4 ps-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-400 focus:border-blue-700"
              placeholder="Search by Order ID..." required />
          </div>
        </div>
        <div class="w-48">
          <select [(ngModel)]="statusFilter" (ngModelChange)="filterOrders()" 
            class="block w-full p-4 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-400 focus:border-blue-700">
            <option value="all">All Status</option>
            <option value="Pending">Pending</option>
            <option value="Received">Received</option>
            <option value="Delivered">Delivered</option>
            <option value="Canceled">Canceled</option>
          </select>
        </div>
      </div>

      <div class="bg-white shadow rounded-lg overflow-hidden">
        <table class="min-w-full">
          <thead class="bg-gray-100">
            <tr>
              <th class="px-6 py-3 text-left">ID</th>
              <th class="px-6 py-3 text-left">Customer</th>
              <th class="px-6 py-3 text-left">Total</th>
              <th class="px-6 py-3 text-left">Status</th>
              <th class="px-6 py-3 text-left">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let order of filteredOrders" class="border-b">
              <td class="px-6 py-4">{{ order.id }}</td>

              <!-- <td class="px-6 py-4">{{ order.customerName }}</td> -->
              <td class="px-6 py-4">{{order.customerName}}</td>

              <td class="px-6 py-4">${{ order.totalAmount }}</td>
              <td class="px-6 py-4">
                <span class="inline-block px-2 py-1 rounded" [ngClass]="{
                  'bg-yellow-100 text-yellow-800': order.statusMess === 'Pending',
                  'bg-blue-100 text-blue-800': order.statusMess === 'Received',
                  'bg-green-100 text-green-800': order.statusMess === 'Delivered'
                }">
                  {{ order.statusMess }}
                </span>
              </td>
              <td class="px-6 py-4">
                <a [routerLink]="['/admin/orders', order.id]" class="text-blue-600 hover:underline mr-2">View</a>
                <button (click)="updateStatus(order.id, 'Received')" class="text-blue-600 hover:underline mr-2" *ngIf="order.statusMess === 'Pending'">Mark Received</button>
                <button (click)="updateStatus(order.id, 'Delivered')" class="text-green-600 hover:underline mr-2" *ngIf="order.statusMess === 'Received'">Mark Delivered</button>
                <button (click)="updateStatus(order.id, 'Canceled')" class="text-red-600 hover:underline">Cancele</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>