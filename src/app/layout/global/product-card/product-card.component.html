<div>
    <div class="relative w-full product-card bg-white rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow">
        <!-- Sale/New Tag -->
        <div class="absolute top-0 left-0 z-10">
            @if (product.isNew) {
                <span class="bg-orange-500 text-white text-xs px-3 py-1">NEW</span>
            }
            @if (product.onSale) {
                <span class="bg-blue-500 text-white text-xs px-3 py-1">SALE</span>
            }
        </div>

        <!-- Product Image with Circle Background -->
        <div class="relative aspect-square overflow-hidden bg-gray-50">
            <div class="absolute inset-0 bg-gradient-to-b from-gray-100 to-white rounded-full transform scale-150 -translate-y-1/4"></div>
            <img [routerLink]="['/Details', product.Id]" 
                 [src]="product.ImageCover" 
                 [alt]="product.Title"
                 class="relative z-10 w-full h-full object-contain p-6 transition-transform hover:scale-105">
            
            <!-- Wishlist Button -->
            <div class="absolute top-2 right-2 z-20">
                @if (WishListIDs?.includes(product.Id)) {
                    <button (click)="removeFromWishList(product.Id)" 
                            [class.opacity-50]="wishListLoading"
                            [disabled]="wishListLoading">
                        <fa-icon size="lg" [icon]="faHeart" class="text-red-500"></fa-icon>
                    </button>
                } @else {
                    <button (click)="addToWishList(product.Id)"
                            [class.opacity-50]="wishListLoading"
                            [disabled]="wishListLoading">
                        <fa-icon size="lg" [icon]="faHeart" class="text-gray-400 hover:text-red-500"></fa-icon>
                    </button>
                }
            </div>
        </div>

        <!-- Product Info -->
        <div class="p-4">
            <!-- Rating -->
            <div class="flex items-center mb-2">
                @for (item of [1,2,3,4,5].slice(0, product.ratingsAverage); track $index) {
                    <fa-icon size="xs" [icon]="faStar" class="text-yellow-400"></fa-icon>
                }
                @if (product.ratingsAverage % 1 != 0) {
                    <fa-icon size="xs" [icon]="faStarHalf" class="text-yellow-400"></fa-icon>
                }
            </div>

            <!-- Title -->
            <h3 [routerLink]="['/Details', product.Id]" 
                class="text-sm font-medium text-gray-800 mb-1 hover:text-primary cursor-pointer line-clamp-2">
                {{product.Title}}
            </h3>

            <!-- Price and Cart -->
            <div class="flex items-center justify-between">
                <span class="text-lg font-bold text-gray-900">${{product.Price}}</span>
                
                <!-- Add to Cart -->
                <button (click)="addToCart(product.Id)"
                        [disabled]="AddLoading && itemId == product.Id"
                        class="rounded-full p-2 bg-orange-500 text-white hover:bg-orange-600 transition-colors">
                    @if (AddLoading && itemId == product.Id) {
                        <fa-icon [icon]="faSpinner" [spin]="true"></fa-icon>
                    } @else {
                        <fa-icon [icon]="faShoppingCart"></fa-icon>
                    }
                </button>
            </div>
        </div>
    </div>
</div>